# 연습 랩 1: Microsoft Graph 커넥터에 대한 연결 구성

## WWL 테넌트 - 사용 약관

강사 진행 교육 중에 테넌트를 제공받는 경우, 그 테넌트는 해당 강사 진행 교육에서 실습 랩을 지원하기 위해 주어진 것입니다.

테넌트를 실습 랩 외부에서 공유하거나 사용해서는 안 됩니다. 이 과정에서 사용되는 테넌트는 평가판 테넌트이며 클래스가 종료된 후 사용하거나 액세스할 수 없으며 연장할 수 없습니다.

테넌트를 유료 구독으로 변환해서는 안 됩니다. 이 과정의 일부로 얻은 테넌트는 Microsoft Corporation의 재산으로 유지되며 언제든지 액세스 권한을 획득하고 다시 소유할 수 있는 권리를 보유합니다.

## 요약

이 랩에서는 Microsoft 365 관리 센터를 사용하여 Microsoft 파일 공유 커넥터를 통해 고객 파일에 연결을 구축할 것입니다.

중간 규모 회사인 Contoso의 고객 서비스 관리자라고 상상해 보세요. 팀은 고객 문의를 처리할 때 응답 시간과 전반적인 효율성에 어려움을 겪고 있습니다. Microsoft 365 관리 센터를 활용하여 고객 서비스 에이전트가 고객 파일에 빠르게 액세스하고 참조할 수 있도록 FileShare 연결을 만들기로 결정합니다.

## 연습 1: Microsoft 365 관리 센터에서 연결 구성

### VM에 로그인

랩 호스팅 공급자는 기본 테넌트 관리자인 MOD 관리자 계정에 대한 암호를 제공합니다. 보안을 위해 Microsoft는 미리 정의된 모든 사용자가 다음 로그인 시 반드시 암호를 변경하도록 평가판 테넌트를 구성했습니다. 랩 호스팅 공급자에서 만든 로컬 **관리자** 계정으로 **LON-CL1**에 **Pa55w.rd** 비밀번호로 로그인합니다.

### 작업 1: Azure Portal에서 권한 부여

1. Azure Portal**https://www.portal.azure.com**로 이동하여 관리자 자격 증명으로 로그인합니다. 암호를 저장하지 말고, **로그인 상태 유지?** 에 **예**를 선택하세요.
2. **Microsoft Azure 시작** 화면에서 **취소**를 선택합니다.
1. 화면 왼쪽의 드롭다운 메뉴 아이콘을 선택하여 포털 메뉴를 표시합니다. **Microsoft Entra ID -> 관리 -> 앱 등록**을 선택합니다.
1. 상단 메뉴 모음에서 **새 등록**을 선택합니다. **애플리케이션 등록 페이지**가 표시됩니다. 이 페이지에서 앱의 이름을 입력합니다. 이 앱 의 이름을 **Contoso Fileshare로 지정**해 보겠습니다. 기본 지원 계정 유형 옵션은 **이 조직 디렉터리의 계정만(Contoso 전용 - 단일 테넌트)** 으로 두세요. 선택적 **리디렉션 URI**는 선택하지 마세요.
1. **등록**을 선택합니다. 애플리케이션이 만들어지고 애플리케이션 ID가 할당됩니다. 다음 단계에서 GCA(Graph 커넥터 에이전트)를 만들 때 이 정보를 사용할 것입니다. GCA를 만들기 전에 필요한 설정을 구성해 보겠습니다.

다음 단계는 Azure Portal에서 Graph 커넥터 에이전트에 대한 권한을 부여하는 것입니다.

1. 왼쪽 메뉴에서 **API 권한** 옵션을 선택합니다.
1. **권한 추가 -> Microsoft Graph -> 애플리케이션 권한**을 선택하고, 다음 API에 대한 권한을 허용합니다.

    - Directory -> Directory.Read.All
    - ExternalConnection -> ExternalConnection.ReadWrite.OwnedBy
    - ExternalItem -> ExternalItem.ReadWrite.All
      
1. **사용 권한 추가** 단추를 선택합니다.
1. **Contoso에 대한 관리자 동의 부여**를 선택하고 **예**를 선택하여 확인합니다.

**참고:** 이 Edge 브라우저 탭을 닫지 마세요. 다음 작업을 수행하려면 Azure Portal에서 정보를 복사하여 붙여넣어야 합니다.

### 작업 2: GCA 설치

1. 새 Microsoft Edge 브라우저 탭을 엽니다. 다음 URL로 이동하여 Graph 커넥터 에이전트: **https://www.microsoft.com/en-us/download/details.aspx?id=104045**를 다운로드합니다. **다운로드** 단추를 선택합니다. 
1. **GcaInstaller_3.1.1.0.msi** 파일을 열고 설치 마법사의 프롬프트를 따릅니다. 
2. 화면 아래쪽의 **검색** 바에서 **Graph 커넥터 에이전트 구성**을 입력하고 앱이 나타나면 메뉴에서 앱을 선택합니다.
3. **예**를 클릭하여 앱이 디바이스를 변경할 수 있도록 허용합니다.
4. **MOD 관리** 계정을 사용하여 GCA에 로그인하고 등록합니다. 인증이 완료되었다는 확인 메시지가 Edge 브라우저에 나타납니다. 이 창을 닫을 수 있습니다.
5. 화면 아래쪽의 아이콘을 선택하여 GCA 앱을 엽니다.
1. 이 에이전트의 이름을 **ContosoFiles**로 지정합니다.
1. Azure Portal Microsoft Edge 탭(**Contoso Fileshare - Microsoft Azure**를 읽어야 합니다)을 선택하고, **개요** 화면으로 이동하여 **애플리케이션(클라이언트) ID**를 복사합니다. GCA 설치 앱에 붙여넣습니다.

다음으로, Azure Portal에서 이 앱의 클라이언트 암호를 설정해야 합니다.

1. Azure Portal 에지 탭으로 돌아가서 **인증서 및 암호**로 이동합니다.
1. **+ 새 클라이언트 암호**를 선택합니다. **Contoso 파일**을 입력하여 **설명**을 추가합니다. 만료 필드를 기본 180일로 그대로 둘 수 있습니다.
2. **추가**를 선택합니다.
3. 자동 암호의 **값** 필드를 복사합니다.
1. Graph 커넥터 에이전트 앱으로 돌아가서, GCA 설치 관리자 앱의 **애플리케이션 암호(클라이언트 암호)** 필드에 값을 붙여넣습니다.
1. **등록**을 선택합니다.
1. 등록이 완료되면 설치 관리자 앱을 닫습니다.

### 작업 3: Github에서 리소스 파일 다운로드

GCA를 사용하여 커넥터를 구성하려면 시스템에 로컬로 저장된 파일이 필요합니다. 

1. 새 Edge 브라우저를 열고 주소 표시줄에 **https://github.com/MicrosoftLearning/MS-4014-Build-a-foundation-to-extend-Microsoft-365-Copilot/tree/master/ResourceFiles**를 입력합니다.
2. 폴더에서 첫 번째 파일인 **Contoso Chai Tea market trends 2023.xls** 파일을 선택하여 엽니다.
3. 화면 오른쪽 위에 있는 **줄임표(추가 파일 작업)** 단추를 선택한 다음 **다운로드**를 선택합니다.
4. 나머지 파일 각각에 대해 3단계를 반복합니다.
5. 다운로드가 완료되면 이 창을 닫을 수 있습니다.
6. 파일 탐색기에서 C:\ directory로 이동합니다. **ResourceFiles**라는 새 폴더를 만듭니다.
7. 새 파일 탐색기 창을 열고 **Download** 폴더로 이동하여 GitHub에서 다운로드한 Contoso 파일에 액세스합니다. 이 파일을 **C:\ResourceFiles** 디렉터리에 복사합니다.

이 파일을 Microsoft 관리 센터에서 생성할 연결의 원본 콘텐츠로 사용할 것입니다.

### 작업 4: Microsoft 관리 센터 열기

1. 새 Microsoft Edge 브라우저탭을 엽니다. Microsoft Edge 브라우저에서 주소 표시줄에 URL(**https://portal.office.com**)을 입력하여 **Microsoft 365 홈** 페이지로 이동합니다.
1. 로그인하라는 메시지가 표시되면 랩 호스팅 공급자가 Microsoft 365 평가판 테넌트에 대해 제공한 LON-CL1 **사용자 이름** 및 **암호**를 입력합니다. 사용자 이름은 **<admin@xxxxxZZZZZZ.onmicrosoft.com>** 양식이어야 하며, 여기서 xxxxxZZZZZZ는 랩 호스팅 공급자가 할당한 테넌트 접두사입니다. 
1. **Microsoft 365 시작** 페이지가 Microsoft Edge 브라우저의 **홈 | Microsoft 365** 탭에 나타납니다. 이 페이지는 MOD 관리자의 Microsoft 365 홈페이지입니다.
1. 탐색 창에 표시되는 애플리케이션 아이콘 목록에서 **관리자**를 선택합니다. 그러면 새 브라우저 탭에 **Microsoft 365 관리 센터**가 열립니다.
1. 전체 탐색 메뉴를 표시하려면 **...모두 표시**를 선택합니다. **설정** -> **검색 및 인텔리전스**를 선택합니다.
1. 표시되는 ** 개요** 탭에서 아래로 스크롤합니다. **커넥터** 상자에서 **첫 번째 연결 추가**를 선택합니다.

여기에서 사용 가능한 데이터 원본 목록이 나열됩니다. 파일 공유 커넥터를 사용하여 연결을 구성하고 있습니다. 이 커넥터를 사용하면 Microsoft 365 Copilot 검색이 Copilot 검색 내에서 고객 파일을 참조할 수 있으며, 고객 서비스 에이전트가 답변을 찾을 때 더 빨리 더 정확한 응답을 제공할 수 있습니다.

1. **파일 공유**를 선택한 후 **다음**를 선택합니다.
1. **표시 이름**을 입력합니다. 표시 이름은 사용자에게 표시되는 고유한 이름입니다. 필드에 **Contoso 파일**을 입력해 보겠습니다.
1. **폴더 경로**를 입력합니다. 다음 디렉터리에 샘플 파일이 구성되어 있습니다.

   **C:\ResourceFiles**

이 경로가 파일이 저장된 디렉터리입니다.

1. 기본 옵션이 아닌 경우, **Graph 커넥터 에이전트** 필드에서 이전 단계(ContosoFiles)에서 만든 GCA를 선택합니다.
1. 인증 유형으로 **Windows**를 선택한 다음, Windows 인증을 위해 LON-CLI **사용자 이름** 및 **암호**를 입력합니다.
1. 테넌트에 타사 데이터의 인덱스 만들기 권한을 Microsoft에 부여하려면 확인란을 선택합니다.
1. **만들기**를 실행합니다.  성공 화면이 나타나고 연결이 동기화되기 시작합니다. **커넥터 설명** 상자에서 특정 유형의 콘텐츠, 해당 사용의 이점을 누릴 수 있는 조직의 부서 또는 워크플로의 예를 입력할 수 있습니다. 예시:

    **이 커넥터는 온-프레미스 파일 공유 서버에 포함된 정보를 포함합니다. 여기에는 고객 쿼리에 응답할 때 지원 에 도움이 될 수 있는 고객 프로필 및 고객 질문이 포함됩니다.**
1. **완료**를 선택합니다. 이제 연결이 Microsoft 365 관리 센터 **검색 및 인텔리전스** 탭에 표시되며, 검색 결과 또는 Microsoft 365 Copilot 에이전트를 빌드할 때 참조할 수 있습니다.
